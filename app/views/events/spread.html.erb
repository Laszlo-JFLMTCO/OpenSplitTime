<div class="row">
  <h2><%= @event.name %></h2>
</div>
<div class="row">
  <strong><%= "#{@event.first_start_time.to_formatted_s(:long)}" %></strong><br/>
  <strong>Course:</strong>
  <%= link_to @event.course.name, course_path(@event.course) %>
  <% if @event.race %> |
      <strong>Race:</strong>
      <%= link_to @event.race.name, race_path(@event.race) %>
  <% end %>
</div>
<hr>
<div class="row">
  <%= link_to '<< Back to event', event_path(@event), class: 'btn btn-sm btn-default' %>
</div>
<hr>
<div class="row">
  <table class="table table-condensed table-striped">
    <thead>
    <tr>
      <th>Bib #</th>
      <th>Name</th>
      <th>Category</th>
      <th>From</th>
      <% ordered_splits = @event.ordered_splits_without_start %>
      <% ordered_splits.each do |split| %>
          <th><%= split.name %></th>
      <% end %>
    </tr>
    </thead>
    <tbody>
    <% time_array = @event.efforts.sorted_ultra_time_array %>
    <% efforts = Effort.efforts_from_ids(time_array.map { |x| x[0] }) %>
    <% time_array.each do |row| %>
        <% effort = efforts.find { |s| s.id == row[0] } %>
        <% if effort.bad? %>
            <tr class="text-success">
        <% elsif effort.questionable? %>
            <tr class="text-success">
        <% else %>
            <tr>
        <% end %>
          <td><%= effort.bib_number %></td>
          <td><strong><%= link_to effort.full_name, effort_path(effort) %></strong></td>
          <td><%= effort.bio_historic %></td>
          <td><%= effort.state_and_country %></td>
          <% (1...row.size - 1).each do |i| %>
              <% if data_status(row[-1][i]) == 'bad' %>
                <td class="text-danger"><strong>
            <% elsif data_status(row[-1][i]) == 'questionable' %>
                <td class="text-warning"><strong>
            <% else %>
                <td>
            <% end %>
                <%= time_format_hhmm(row[i]) %>
              </strong>
            </td>
          <% end %>
        </tr>
    <% end %>
    </tbody>
  </table>
</div>