<%# Requires parameter obj(collection) %>

<table class="table table-condensed table-striped">
  <thead>
  <tr>
    <th>Name</th>
    <th>Details</th>
    <th>Location</th>
    <% unless controller.controller_name == "events" && controller.action_name == "show" %>
        <th>Actions</th>
    <% end %>
  </tr>
  </thead>
  <tbody>
  <% obj.each do |split| %>
      <tr>
        <td><strong><%= link_to split.name, split_path(split) %></strong></td>
        <td><%= "#{split.kind.titlecase}: Mile #{split.distance_from_start.meters.to.miles.round(1)} on #{split.course.name}" %></td>
        <% if split.location %>
            <td><%= link_to split.location.name, location_path(split.location) %></td>
        <% else %>
            <td><%= link_to "Create", new_location_path(split_id: split.id), class: "btn btn-xs btn-success" %></td>
        <% end %>
        <td>
          <% unless controller.controller_name == "events" && controller.action_name == "show" %>
              <% if @current_user && @current_user.authorized_to_edit?(split) %>
                  <% if @course.nil? %>
                      <%= link_to 'Edit Split', edit_split_path(split), class: "btn btn-xs btn-primary" %>
                  <% else %>
                      <%= link_to 'Edit Split', edit_split_path(split, course_id: @course.id), class: "btn btn-xs btn-primary" %>
                  <% end %>
                  <%= link_to 'Delete Split', split_path(split), class: "btn btn-xs btn-danger",
                              method: :delete,
                              data: {confirm: 'Are you sure?'} %>
              <% end %>
          <% end %>
        </td>
      </tr>
  <% end %>
  </tbody>
</table>
